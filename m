Return-Path: <etnaviv-bounces@lists.freedesktop.org>
X-Original-To: lists+etnaviv@lfdr.de
Delivered-To: lists+etnaviv@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3206A188AC
	for <lists+etnaviv@lfdr.de>; Thu,  9 May 2019 13:09:52 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E39B889B33;
	Thu,  9 May 2019 11:09:50 +0000 (UTC)
X-Original-To: etnaviv@lists.freedesktop.org
Delivered-To: etnaviv@lists.freedesktop.org
Received: from mail-wm1-x342.google.com (mail-wm1-x342.google.com
 [IPv6:2a00:1450:4864:20::342])
 by gabe.freedesktop.org (Postfix) with ESMTPS id CE74B89B33;
 Thu,  9 May 2019 11:09:49 +0000 (UTC)
Received: by mail-wm1-x342.google.com with SMTP id 198so2726199wme.3;
 Thu, 09 May 2019 04:09:49 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=Vns6fjk9Q8zhYudP0ZidKAuRYNIcOAP6uGf4+4dX234=;
 b=p4g+KJ0iI6VCDN6SAmMzHLMUttcveoau6iJJldqutVp9BDuIO+nWYh4rnUVJyrtYAn
 ixHJJm3zbFdOXyOclod3gCYvbfd1qUTWIBjFjjwIWSMp+dK/yagB+AwZXhe/btUvL9kt
 ZGbpXVJUwbhemmBGaRMN2JK2+EqRwTQCuIs74fguHXaGDotWDpE51laq5V7zEGK58a3h
 I9VsES3eHrFALywPKBIFHnHK3N2ByS4eDQJ9Wo0dNSN1pbsC1Nku2Alf1SbVJfTu+emJ
 Rk5gBPV6UGevTh5WVwuqXl7o9gofmjg6PSBWzkagd6VGscX+j10RbmmVCtO0VX5WRO8j
 sv5A==
X-Gm-Message-State: APjAAAUdEBuVdIcxxB+dqGi1rIYm1x0qjGFV4gsRbxrI6+eylBKduG9q
 3eV723eLVDx36QgLxxSmwsJ+RsdGl6o=
X-Google-Smtp-Source: APXvYqxUhts+sAOjtrmdwiq+cGL8kRHDmk8ZBl1VEaM/bHHABwlosEbSIHsIz9/ma1odqZIi8ws0Zw==
X-Received: by 2002:a1c:1902:: with SMTP id 2mr2384997wmz.153.1557400188112;
 Thu, 09 May 2019 04:09:48 -0700 (PDT)
Received: from chgm-pc-linux.bachmann.at ([185.67.228.2])
 by smtp.gmail.com with ESMTPSA id b8sm1313911wrr.64.2019.05.09.04.09.47
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Thu, 09 May 2019 04:09:47 -0700 (PDT)
From: Christian Gmeiner <christian.gmeiner@gmail.com>
To: mesa-dev@lists.freedesktop.org
Subject: [PATCH] etnaviv: calculate load balancing value at link time
Date: Thu,  9 May 2019 13:09:45 +0200
Message-Id: <20190509110945.5267-1-christian.gmeiner@gmail.com>
X-Mailer: git-send-email 2.21.0
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:mime-version
 :content-transfer-encoding;
 bh=Vns6fjk9Q8zhYudP0ZidKAuRYNIcOAP6uGf4+4dX234=;
 b=NjWEYFd7B7GCGkV/yjg5KXmpw74kMv/r5ZfgRGaMoIpeqjP83Dra1G4qQ+tMCDb4nT
 M4EzoYSBPclEviKvmHBhYNJrUCBsv/soM0hVZ5IdylD38p+SY8cMfWDvclCYaxvSLh3f
 tNSp276lcFzKlk2OLZ1q0Dz1+Opr+we9IN6papogeTxD7XXDmVPR3aDXJUnwNiyEdW98
 EeQE2FxGJTtbKqYhrmx8yJrW50DpGMPV5n9mDdY3DNUJWbgHr0aXHwmRcLnVAX3ib+T1
 fssW0f1C+2zXGKJ2P3v4KQkZj4ooKTmj5YzngFQU2LDZaPSZoP6gFCQqwa6cFSgodqpJ
 cMow==
X-BeenThere: etnaviv@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <etnaviv.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/etnaviv>,
 <mailto:etnaviv-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/etnaviv>
List-Post: <mailto:etnaviv@lists.freedesktop.org>
List-Help: <mailto:etnaviv-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/etnaviv>,
 <mailto:etnaviv-request@lists.freedesktop.org?subject=subscribe>
Cc: Christian Gmeiner <christian.gmeiner@gmail.com>,
 etnaviv@lists.freedesktop.org, cphealy@gmail.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: etnaviv-bounces@lists.freedesktop.org
Sender: "etnaviv" <etnaviv-bounces@lists.freedesktop.org>

TW92ZSB0aGUgY2FsY3VsYXRpb24gb3V0IG9mIHRoZSBjb21waWxlci4KClNpZ25lZC1vZmYtYnk6
IENocmlzdGlhbiBHbWVpbmVyIDxjaHJpc3RpYW4uZ21laW5lckBnbWFpbC5jb20+Ci0tLQogLi4u
L2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X2NvbXBpbGVyLmMgICAgICAgIHwgMjggLS0tLS0tLS0t
LS0tLS0tLQogLi4uL2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X2NvbXBpbGVyLmggICAgICAgIHwg
IDEgLQogc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfc2hhZGVyLmMgIHwgMzIg
KysrKysrKysrKysrKysrKystLQogMyBmaWxlcyBjaGFuZ2VkLCAzMCBpbnNlcnRpb25zKCspLCAz
MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9zcmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYv
ZXRuYXZpdl9jb21waWxlci5jIGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZf
Y29tcGlsZXIuYwppbmRleCBjZWNhNWI4YWY5OS4uNGJiNGYzMjViN2EgMTAwNjQ0Ci0tLSBhL3Ny
Yy9nYWxsaXVtL2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X2NvbXBpbGVyLmMKKysrIGIvc3JjL2dh
bGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfY29tcGlsZXIuYwpAQCAtMjE5MiwzMyArMjE5
Miw2IEBAIGZpbGxfaW5fdnNfb3V0cHV0cyhzdHJ1Y3QgZXRuYV9zaGFkZXJfdmFyaWFudCAqc29i
aiwgc3RydWN0IGV0bmFfY29tcGlsZSAqYykKIAogICAgLyogYnVpbGQgdHdvLWxldmVsIGluZGV4
IGZvciBsaW5raW5nICovCiAgICBidWlsZF9vdXRwdXRfaW5kZXgoc29iaik7Ci0KLSAgIC8qIGZp
bGwgaW4gIm15c3RlcnkgbWVhdCIgbG9hZCBiYWxhbmNpbmcgdmFsdWUuIFRoaXMgdmFsdWUgZGV0
ZXJtaW5lcyBob3cKLSAgICAqIHdvcmsgaXMgc2NoZWR1bGVkIGJldHdlZW4gVlMgYW5kIFBTCi0g
ICAgKiBpbiB0aGUgdW5pZmllZCBzaGFkZXIgYXJjaGl0ZWN0dXJlLiBNb3JlIHByZWNpc2VseSwg
aXQgaXMgZGV0ZXJtaW5lZCBmcm9tCi0gICAgKiB0aGUgbnVtYmVyIG9mIFZTIG91dHB1dHMsIGFz
IHdlbGwgYXMgY2hpcC1zcGVjaWZpYwotICAgICogdmVydGV4IG91dHB1dCBidWZmZXIgc2l6ZSwg
dmVydGV4IGNhY2hlIHNpemUsIGFuZCB0aGUgbnVtYmVyIG9mIHNoYWRlcgotICAgICogY29yZXMu
Ci0gICAgKgotICAgICogWFhYIHRoaXMgaXMgYSBjb25zZXJ2YXRpdmUgZXN0aW1hdGUsIHRoZSAi
b3B0aW1hbCIgdmFsdWUgaXMgb25seSBrbm93biBmb3IKLSAgICAqIHN1cmUgYXQgbGluayB0aW1l
IGJlY2F1c2Ugc29tZQotICAgICogb3V0cHV0cyBtYXkgYmUgdW51c2VkIGFuZCB0aHVzIHVubWFw
cGVkLiBUaGVuIGFnYWluLCBpbiB0aGUgZ2VuZXJhbCB1c2UKLSAgICAqIGNhc2Ugd2l0aCBHTFNM
IHRoZSB2ZXJ0ZXggYW5kIGZyYWdtZW50Ci0gICAgKiBzaGFkZXJzIGFyZSBsaW5rZWQgYWxyZWFk
eSBiZWZvcmUgc3VibWl0dGluZyB0byBHYWxsaXVtLCB0aHVzIGFsbCBvdXRwdXRzCi0gICAgKiBh
cmUgdXNlZC4KLSAgICAqLwotICAgaW50IGhhbGZfb3V0ID0gKGMtPmZpbGVbVEdTSV9GSUxFX09V
VFBVVF0ucmVnX3NpemUgKyAxKSAvIDI7Ci0gICBhc3NlcnQoaGFsZl9vdXQpOwotCi0gICB1aW50
MzJfdCBiID0gKCgyMDQ4MCAvIChjLT5zcGVjcy0+dmVydGV4X291dHB1dF9idWZmZXJfc2l6ZSAt
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAyICogaGFsZl9vdXQgKiBjLT5zcGVjcy0+dmVy
dGV4X2NhY2hlX3NpemUpKSArCi0gICAgICAgICAgICAgICAgIDkpIC8KLSAgICAgICAgICAgICAg
ICAxMDsKLSAgIHVpbnQzMl90IGEgPSAoYiArIDI1NiAvIChjLT5zcGVjcy0+c2hhZGVyX2NvcmVf
Y291bnQgKiBoYWxmX291dCkpIC8gMjsKLSAgIHNvYmotPnZzX2xvYWRfYmFsYW5jaW5nID0gVklW
U19WU19MT0FEX0JBTEFOQ0lOR19BKE1JTjIoYSwgMjU1KSkgfAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBWSVZTX1ZTX0xPQURfQkFMQU5DSU5HX0IoTUlOMihiLCAyNTUpKSB8Ci0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFZJVlNfVlNfTE9BRF9CQUxBTkNJTkdfQygweDNmKSB8
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZJVlNfVlNfTE9BRF9CQUxBTkNJTkdfRCgw
eDBmKTsKIH0KIAogc3RhdGljIGJvb2wKQEAgLTI1MTMsNyArMjQ4Niw2IEBAIGV0bmFfZHVtcF9z
aGFkZXIoY29uc3Qgc3RydWN0IGV0bmFfc2hhZGVyX3ZhcmlhbnQgKnNoYWRlcikKICAgIGlmIChz
aGFkZXItPnByb2Nlc3NvciA9PSBQSVBFX1NIQURFUl9WRVJURVgpIHsKICAgICAgIHByaW50Zigi
ICB2c19wb3Nfb3V0X3JlZz0laVxuIiwgc2hhZGVyLT52c19wb3Nfb3V0X3JlZyk7CiAgICAgICBw
cmludGYoIiAgdnNfcG9pbnRzaXplX291dF9yZWc9JWlcbiIsIHNoYWRlci0+dnNfcG9pbnRzaXpl
X291dF9yZWcpOwotICAgICAgcHJpbnRmKCIgIHZzX2xvYWRfYmFsYW5jaW5nPTB4JTA4eFxuIiwg
c2hhZGVyLT52c19sb2FkX2JhbGFuY2luZyk7CiAgICB9IGVsc2UgewogICAgICAgcHJpbnRmKCIg
IHBzX2NvbG9yX291dF9yZWc9JWlcbiIsIHNoYWRlci0+cHNfY29sb3Jfb3V0X3JlZyk7CiAgICAg
ICBwcmludGYoIiAgcHNfZGVwdGhfb3V0X3JlZz0laVxuIiwgc2hhZGVyLT5wc19kZXB0aF9vdXRf
cmVnKTsKZGlmZiAtLWdpdCBhL3NyYy9nYWxsaXVtL2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X2Nv
bXBpbGVyLmggYi9zcmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYvZXRuYXZpdl9jb21waWxlci5o
CmluZGV4IDQ4YjFiMjE4NzUwLi45ODVkODMxMDg1MCAxMDA2NDQKLS0tIGEvc3JjL2dhbGxpdW0v
ZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfY29tcGlsZXIuaAorKysgYi9zcmMvZ2FsbGl1bS9kcml2
ZXJzL2V0bmF2aXYvZXRuYXZpdl9jb21waWxlci5oCkBAIC04NSw3ICs4NSw2IEBAIHN0cnVjdCBl
dG5hX3NoYWRlcl92YXJpYW50IHsKICAgIC8qIHNwZWNpYWwgb3V0cHV0cyAodnMgb25seSkgKi8K
ICAgIGludCB2c19wb3Nfb3V0X3JlZzsgLyogVlMgcG9zaXRpb24gb3V0cHV0ICovCiAgICBpbnQg
dnNfcG9pbnRzaXplX291dF9yZWc7IC8qIFZTIHBvaW50IHNpemUgb3V0cHV0ICovCi0gICB1aW50
MzJfdCB2c19sb2FkX2JhbGFuY2luZzsKIAogICAgLyogc3BlY2lhbCBvdXRwdXRzIChwcyBvbmx5
KSAqLwogICAgaW50IHBzX2NvbG9yX291dF9yZWc7IC8qIGNvbG9yIG91dHB1dCByZWdpc3RlciAq
LwpkaWZmIC0tZ2l0IGEvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfc2hhZGVy
LmMgYi9zcmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYvZXRuYXZpdl9zaGFkZXIuYwppbmRleCBk
MmQ3MzZiZGVlNS4uMDNiYTk0ZmY1ZmEgMTAwNjQ0Ci0tLSBhL3NyYy9nYWxsaXVtL2RyaXZlcnMv
ZXRuYXZpdi9ldG5hdml2X3NoYWRlci5jCisrKyBiL3NyYy9nYWxsaXVtL2RyaXZlcnMvZXRuYXZp
di9ldG5hdml2X3NoYWRlci5jCkBAIC01Myw2ICs1MywzMSBAQCBzdGF0aWMgYm9vbCBldG5hX2lj
YWNoZV91cGxvYWRfc2hhZGVyKHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCwgc3RydWN0IGV0bmFf
c2hhZAogICAgcmV0dXJuIHRydWU7CiB9CiAKK3N0YXRpYyB1aW50MzJfdAorZXRuYV9jYWxjdWxh
dGVfbG9hZF9iYWxhbmNlKGNvbnN0IHN0cnVjdCBldG5hX3NwZWNzICpzcGVjcywgdW5zaWduZWQg
bnVtX3JlZ3MpCit7CisgICAvKiBmaWxsIGluICJteXN0ZXJ5IG1lYXQiIGxvYWQgYmFsYW5jaW5n
IHZhbHVlLiBUaGlzIHZhbHVlIGRldGVybWluZXMgaG93CisgICAgKiB3b3JrIGlzIHNjaGVkdWxl
ZCBiZXR3ZWVuIFZTIGFuZCBQUworICAgICogaW4gdGhlIHVuaWZpZWQgc2hhZGVyIGFyY2hpdGVj
dHVyZS4gTW9yZSBwcmVjaXNlbHksIGl0IGlzIGRldGVybWluZWQgZnJvbQorICAgICogdGhlIG51
bWJlciBvZiBWUyBvdXRwdXRzLCBhcyB3ZWxsIGFzIGNoaXAtc3BlY2lmaWMKKyAgICAqIHZlcnRl
eCBvdXRwdXQgYnVmZmVyIHNpemUsIHZlcnRleCBjYWNoZSBzaXplLCBhbmQgdGhlIG51bWJlciBv
ZiBzaGFkZXIKKyAgICAqIGNvcmVzLgorICAgICovCisgICB1bnNpZ25lZCBoYWxmX291dCA9IChu
dW1fcmVncyArIDEpIC8gMjsKKyAgIGFzc2VydChoYWxmX291dCk7CisKKyAgIHVpbnQzMl90IGIg
PSAoKDIwNDgwIC8gKHNwZWNzLT52ZXJ0ZXhfb3V0cHV0X2J1ZmZlcl9zaXplIC0KKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgIDIgKiBoYWxmX291dCAqIHNwZWNzLT52ZXJ0ZXhfY2FjaGVfc2l6
ZSkpICsKKyAgICAgICAgICAgICAgICAgOSkgLworICAgICAgICAgICAgICAgIDEwOworICAgdWlu
dDMyX3QgYSA9IChiICsgMjU2IC8gKHNwZWNzLT5zaGFkZXJfY29yZV9jb3VudCAqIGhhbGZfb3V0
KSkgLyAyOworCisgICByZXR1cm4gVklWU19WU19MT0FEX0JBTEFOQ0lOR19BKE1JTjIoYSwgMjU1
KSkgfAorICAgICAgICAgIFZJVlNfVlNfTE9BRF9CQUxBTkNJTkdfQihNSU4yKGIsIDI1NSkpIHwK
KyAgICAgICAgICBWSVZTX1ZTX0xPQURfQkFMQU5DSU5HX0MoMHgzZikgfAorICAgICAgICAgIFZJ
VlNfVlNfTE9BRF9CQUxBTkNJTkdfRCgweDBmKTsKK30KKwogLyogTGluayB2cyBhbmQgZnMgdG9n
ZXRoZXI6IGZpbGwgaW4gc2hhZGVyX3N0YXRlIGZyb20gdnMgYW5kIGZzCiAgKiBhcyB0aGlzIGZ1
bmN0aW9uIGlzIGNhbGxlZCBldmVyeSB0aW1lIGEgbmV3IGZzIG9yIHZzIGlzIGJvdW5kLCB0aGUg
Z29hbCBpcyB0bwogICogZG8gbGl0dGxlIHByb2Nlc3NpbmcgYXMgcG9zc2libGUgaGVyZSwgYW5k
IHRvIHByZWNvbXB1dGUgYXMgbXVjaCBhcyBwb3NzaWJsZSBpbgpAQCAtMTM5LDkgKzE2NCwxMiBA
QCBldG5hX2xpbmtfc2hhZGVycyhzdHJ1Y3QgZXRuYV9jb250ZXh0ICpjdHgsIHN0cnVjdCBjb21w
aWxlZF9zaGFkZXJfc3RhdGUgKmNzLAogICAgICAgY3MtPlZTX09VVFBVVF9DT1VOVF9QU0laRSA9
IGNzLT5WU19PVVRQVVRfQ09VTlQ7CiAgICB9CiAKLSAgIGNzLT5WU19MT0FEX0JBTEFOQ0lORyA9
IHZzLT52c19sb2FkX2JhbGFuY2luZzsKLSAgIGNzLT5WU19TVEFSVF9QQyA9IDA7CisgICB1bnNp
Z25lZCBudW1fcmVncyA9IHZzLT5vdXRmaWxlLm51bV9yZWc7CisgICBudW1fcmVncyArPSBDT05E
KHZzLT52c19wb3Nfb3V0X3JlZyAhPSAtMSwgMSk7CisgICBudW1fcmVncyArPSBDT05EKHZzLT52
c19wb2ludHNpemVfb3V0X3JlZyAhPSAtMSwgMSk7CisgICBjcy0+VlNfTE9BRF9CQUxBTkNJTkcg
PSBldG5hX2NhbGN1bGF0ZV9sb2FkX2JhbGFuY2UoJmN0eC0+c3BlY3MsIG51bV9yZWdzKTsKIAor
ICAgY3MtPlZTX1NUQVJUX1BDID0gMDsKICAgIGNzLT5QU19FTkRfUEMgPSBmcy0+Y29kZV9zaXpl
IC8gNDsKICAgIGNzLT5QU19PVVRQVVRfUkVHID0gZnMtPnBzX2NvbG9yX291dF9yZWc7CiAgICBj
cy0+UFNfSU5QVVRfQ09VTlQgPQotLSAKMi4yMS4wCgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpldG5hdml2IG1haWxpbmcgbGlzdApldG5hdml2QGxpc3Rz
LmZyZWVkZXNrdG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xp
c3RpbmZvL2V0bmF2aXY=
