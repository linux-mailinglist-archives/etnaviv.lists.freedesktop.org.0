Return-Path: <etnaviv-bounces@lists.freedesktop.org>
X-Original-To: lists+etnaviv@lfdr.de
Delivered-To: lists+etnaviv@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 0523319A46
	for <lists+etnaviv@lfdr.de>; Fri, 10 May 2019 11:09:37 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 357C889B66;
	Fri, 10 May 2019 09:09:34 +0000 (UTC)
X-Original-To: etnaviv@lists.freedesktop.org
Delivered-To: etnaviv@lists.freedesktop.org
Received: from mail-wm1-x341.google.com (mail-wm1-x341.google.com
 [IPv6:2a00:1450:4864:20::341])
 by gabe.freedesktop.org (Postfix) with ESMTPS id EE7A589B99;
 Fri, 10 May 2019 09:09:30 +0000 (UTC)
Received: by mail-wm1-x341.google.com with SMTP id o189so6677262wmb.1;
 Fri, 10 May 2019 02:09:30 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=JHZwOOXyLBOZWRXTNMYtT2oOBaFU5c4z20A6jD/YkhE=;
 b=c8435Ux/PcjmVnhLTYUdqlvNyH0hM7jn95rP6ualPyJ5f0bZHPSF9r+XlX2i7Q9v+f
 UIc81kio8l/6xUruDeGhTviKsV7yo0nXwh4AepQYUKbPdU2E/J+dLUCVehZ08PMxE7yI
 MCOpzo5PdmUXZxqYvtI0HYD/265+PVhYQzor8a5elkFKTcXeM17mpeCtmZ0znHFbitfb
 zhVggGCZacMQiFjwHLkJ0QH83E61h/nDpFzAKvX5eeramByuFZS1n9JVof9UZbutN8jG
 AlAjgMoCELewdHtpPfE3wTVQwbY9x19rFeoouTK4YJ6/y8d673jGdMEoiFmuNAw0K5H4
 obUg==
X-Gm-Message-State: APjAAAU+xZyPmKabp/FSrVPMzL5rchayW3in0zxYqDiH9Z3V4mtcnWQL
 QZ1vIRDWmHx7R1uTPOCh5GYOadIsH9g=
X-Google-Smtp-Source: APXvYqyjzumqEY/H1wMv4dQOjYWNjR16ndW+Lu8dRCDNPmvrgrWfixsKj5atP1C8HUUb9UjkPPXOyw==
X-Received: by 2002:a1c:d7:: with SMTP id 206mr6617674wma.69.1557479368773;
 Fri, 10 May 2019 02:09:28 -0700 (PDT)
Received: from localhost.localdomain (80-110-110-254.cgn.dynamic.surfer.at.
 [80.110.110.254])
 by smtp.gmail.com with ESMTPSA id l18sm1645344wrv.38.2019.05.10.02.09.27
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Fri, 10 May 2019 02:09:28 -0700 (PDT)
From: Christian Gmeiner <christian.gmeiner@gmail.com>
To: mesa-dev@lists.freedesktop.org
Subject: [RFC PATCH 09/17] etnaviv: become independed of the used compiler
 backend
Date: Fri, 10 May 2019 11:09:07 +0200
Message-Id: <20190510090915.2739-10-christian.gmeiner@gmail.com>
X-Mailer: git-send-email 2.21.0
In-Reply-To: <20190510090915.2739-1-christian.gmeiner@gmail.com>
References: <20190510090915.2739-1-christian.gmeiner@gmail.com>
MIME-Version: 1.0
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=JHZwOOXyLBOZWRXTNMYtT2oOBaFU5c4z20A6jD/YkhE=;
 b=trXwHf4DZ9XcFNTIsVwO1ZMLieUV2+4ZGgTK454Aa9C+BLi2bQ4CDW96wvV31I8p3a
 IW+lYDEIdDF/Pp5qy+WSmJagnf1HMcLlw0IHhDqxrXG/eYNZL5hdq3EJmIrp69YBOELW
 E9NYOoaXx21Gmlif8kwvybqFLo+wJJtsWuiDJaVIrICSPnDvu8uaW55xsVwI1Z1ohQCq
 mfPvLmUTdJvKDWH3S8KcgZ/3YtZXBeyw6hC+KbPqrPa0b8TpHdZKAny8IV8DrHKJyf8d
 9XDVg2/5OSasAIl/MzfuJI7uGSOzAvHsXHuoe7CWfRKydI7KDwlihydkw8D/72UP0cBj
 wPUw==
X-BeenThere: etnaviv@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: <etnaviv.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/etnaviv>,
 <mailto:etnaviv-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/etnaviv>
List-Post: <mailto:etnaviv@lists.freedesktop.org>
List-Help: <mailto:etnaviv-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/etnaviv>,
 <mailto:etnaviv-request@lists.freedesktop.org?subject=subscribe>
Cc: Christian Gmeiner <christian.gmeiner@gmail.com>,
 etnaviv@lists.freedesktop.org, cphealy@gmail.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: etnaviv-bounces@lists.freedesktop.org
Sender: "etnaviv" <etnaviv-bounces@lists.freedesktop.org>

VGhpcyBjaGFuZ2UgcHJlcHMgZXRuYXZpdiB0byBiZSBhYmxlIHRvIHN3YXAgdGhlIHVzZWQgY29t
cGlsZXIKYmFja2VuZCBlYXNpbHkuIEl0IHRha2VzIGNhcmUgb2YgdW5pZm9ybSBzdHVmZiBhbmQg
dGhlIGFjdHVhbApjcmVhdGlvbiBvZiBzaGFkZXIgdmFyaWFudHMuIEluIHRoZSBsb25nIHJ1biAt
IGlmIG9uZSBiYWNrZW5kCndvbiAtIHdlIGNhbiByZW1vdmUgdGhpcyBhZ2Fpbi4KClNpZ25lZC1v
ZmYtYnk6IENocmlzdGlhbiBHbWVpbmVyIDxjaHJpc3RpYW4uZ21laW5lckBnbWFpbC5jb20+Ci0t
LQogc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfY29udGV4dC5jIHwgMTYgKysr
KysrKysrKysrLS0tLQogc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfY29udGV4
dC5oIHwgMTggKysrKysrKysrKysrKysrKystCiBzcmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYv
ZXRuYXZpdl9lbWl0LmMgICAgfCAxNiArKysrKysrKy0tLS0tLS0tCiBzcmMvZ2FsbGl1bS9kcml2
ZXJzL2V0bmF2aXYvZXRuYXZpdl9zaGFkZXIuYyAgfCAgNSArKystLQogc3JjL2dhbGxpdW0vZHJp
dmVycy9ldG5hdml2L2V0bmF2aXZfc2hhZGVyLmggIHwgIDQgKystLQogc3JjL2dhbGxpdW0vZHJp
dmVycy9ldG5hdml2L2V0bmF2aXZfc3RhdGUuYyAgIHwgMTYgKysrKysrKysrKysrKystLQogLi4u
L2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X3VuaWZvcm1zLmMgICAgICAgIHwgMTkgKysrKysrKysr
KysrKysrKysrLQogLi4uL2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X3VuaWZvcm1zLmggICAgICAg
IHwgIDggKysrKysrKy0KIDggZmlsZXMgY2hhbmdlZCwgODEgaW5zZXJ0aW9ucygrKSwgMjEgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2
aXZfY29udGV4dC5jIGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfY29udGV4
dC5jCmluZGV4IGE1OTMzODQ5MGI2Li5kNzhkODk0MTA4NyAxMDA2NDQKLS0tIGEvc3JjL2dhbGxp
dW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfY29udGV4dC5jCisrKyBiL3NyYy9nYWxsaXVtL2Ry
aXZlcnMvZXRuYXZpdi9ldG5hdml2X2NvbnRleHQuYwpAQCAtNDQsNiArNDQsNyBAQAogI2luY2x1
ZGUgImV0bmF2aXZfdGV4dHVyZS5oIgogI2luY2x1ZGUgImV0bmF2aXZfdHJhbnNmZXIuaCIKICNp
bmNsdWRlICJldG5hdml2X3RyYW5zbGF0ZS5oIgorI2luY2x1ZGUgImV0bmF2aXZfdW5pZm9ybXMu
aCIKICNpbmNsdWRlICJldG5hdml2X3pzYS5oIgogCiAjaW5jbHVkZSAicGlwZS9wX2NvbnRleHQu
aCIKQEAgLTExOSw5ICsxMjAsOSBAQCBldG5hX3VwZGF0ZV9zdGF0ZV9mb3JfZHJhdyhzdHJ1Y3Qg
ZXRuYV9jb250ZXh0ICpjdHgsIGNvbnN0IHN0cnVjdCBwaXBlX2RyYXdfaW5mbwogc3RhdGljIGJv
b2wKIGV0bmFfZ2V0X3ZzKHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCwgc3RydWN0IGV0bmFfc2hh
ZGVyX2tleSBrZXkpCiB7Ci0gICBjb25zdCBzdHJ1Y3QgZXRuYV9zaGFkZXJfdmFyaWFudCAqb2xk
ID0gY3R4LT5zaGFkZXIudnM7CisgICBjb25zdCB2b2lkICpvbGQgPSBjdHgtPnNoYWRlci52czsK
IAotICAgY3R4LT5zaGFkZXIudnMgPSBldG5hX3NoYWRlcl92YXJpYW50KGN0eC0+c2hhZGVyLmJp
bmRfdnMsIGtleSwgJmN0eC0+ZGVidWcpOworICAgY3R4LT5zaGFkZXIudnMgPSBjdHgtPmNyZWF0
ZV9zaGFkZXJfdmFyaWFudChjdHgtPnNoYWRlci5iaW5kX3ZzLCBrZXksICZjdHgtPmRlYnVnKTsK
IAogICAgaWYgKCFjdHgtPnNoYWRlci52cykKICAgICAgIHJldHVybiBmYWxzZTsKQEAgLTEzNSw5
ICsxMzYsOSBAQCBldG5hX2dldF92cyhzdHJ1Y3QgZXRuYV9jb250ZXh0ICpjdHgsIHN0cnVjdCBl
dG5hX3NoYWRlcl9rZXkga2V5KQogc3RhdGljIGJvb2wKIGV0bmFfZ2V0X2ZzKHN0cnVjdCBldG5h
X2NvbnRleHQgKmN0eCwgc3RydWN0IGV0bmFfc2hhZGVyX2tleSBrZXkpCiB7Ci0gICBjb25zdCBz
dHJ1Y3QgZXRuYV9zaGFkZXJfdmFyaWFudCAqb2xkID0gY3R4LT5zaGFkZXIuZnM7CisgICBjb25z
dCB2b2lkICpvbGQgPSBjdHgtPnNoYWRlci5mczsKIAotICAgY3R4LT5zaGFkZXIuZnMgPSBldG5h
X3NoYWRlcl92YXJpYW50KGN0eC0+c2hhZGVyLmJpbmRfZnMsIGtleSwgJmN0eC0+ZGVidWcpOwor
ICAgY3R4LT5zaGFkZXIuZnMgPSBjdHgtPmNyZWF0ZV9zaGFkZXJfdmFyaWFudChjdHgtPnNoYWRl
ci5iaW5kX2ZzLCBrZXksICZjdHgtPmRlYnVnKTsKIAogICAgaWYgKCFjdHgtPnNoYWRlci5mcykK
ICAgICAgIHJldHVybiBmYWxzZTsKQEAgLTQ2NSw2ICs0NjYsMTMgQEAgZXRuYV9jb250ZXh0X2Ny
ZWF0ZShzdHJ1Y3QgcGlwZV9zY3JlZW4gKnBzY3JlZW4sIHZvaWQgKnByaXYsIHVuc2lnbmVkIGZs
YWdzKQogICAgZXRuYV90ZXh0dXJlX2luaXQocGN0eCk7CiAgICBldG5hX3RyYW5zZmVyX2luaXQo
cGN0eCk7CiAKKyAgIGN0eC0+dW5pZm9ybV9kaXJ0eV9mbGFncyA9IGV0bmFfdW5pZm9ybV9kaXJ0
eV9mbGFnczsKKyAgIGN0eC0+dW5pZm9ybXNfd3JpdGUgPSBldG5hX3VuaWZvcm1zX3dyaXRlOwor
ICAgY3R4LT51bmlmb3Jtc19jb25zdF9jb3VudCA9IGV0bmFfdW5pZm9ybXNfY29uc3RfY291bnQ7
CisgICBjdHgtPmNyZWF0ZV9zaGFkZXJfdmFyaWFudCA9IGV0bmFfc2hhZGVyX3ZhcmlhbnQ7Cisg
ICBjdHgtPnNoYWRlcl9saW5rID0gZXRuYV9zaGFkZXJfbGluazsKKyAgIGN0eC0+c2hhZGVyX3Vw
ZGF0ZV92ZXJ0ZXggPSBldG5hX3NoYWRlcl91cGRhdGVfdmVydGV4OworCiAgICBjdHgtPmJsaXR0
ZXIgPSB1dGlsX2JsaXR0ZXJfY3JlYXRlKHBjdHgpOwogICAgaWYgKCFjdHgtPmJsaXR0ZXIpCiAg
ICAgICBnb3RvIGZhaWw7CmRpZmYgLS1naXQgYS9zcmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYv
ZXRuYXZpdl9jb250ZXh0LmggYi9zcmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYvZXRuYXZpdl9j
b250ZXh0LmgKaW5kZXggYTc5ZDczOTEwMGQuLmEyMGYzZDZjZjc5IDEwMDY0NAotLS0gYS9zcmMv
Z2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYvZXRuYXZpdl9jb250ZXh0LmgKKysrIGIvc3JjL2dhbGxp
dW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfY29udGV4dC5oCkBAIC0zMSw2ICszMSw3IEBACiAj
aW5jbHVkZSA8c3RkaW50Lmg+CiAKICNpbmNsdWRlICJldG5hdml2X3Jlc291cmNlLmgiCisjaW5j
bHVkZSAiZXRuYXZpdl9zaGFkZXIuaCIKICNpbmNsdWRlICJldG5hdml2X3RpbGluZy5oIgogI2lu
Y2x1ZGUgImluZGljZXMvdV9wcmltY29udmVydC5oIgogI2luY2x1ZGUgInBpcGUvcF9jb250ZXh0
LmgiCkBAIC04Miw3ICs4Myw3IEBAIHN0cnVjdCBldG5hX3ZlcnRleGJ1Zl9zdGF0ZSB7CiAKIHN0
cnVjdCBldG5hX3NoYWRlcl9zdGF0ZSB7CiAgICB2b2lkICpiaW5kX3ZzLCAqYmluZF9mczsKLSAg
IHN0cnVjdCBldG5hX3NoYWRlcl92YXJpYW50ICp2cywgKmZzOworICAgdm9pZCAqdnMsICpmczsK
IH07CiAKIGVudW0gZXRuYV9pbW1lZGlhdGVfY29udGVudHMgewpAQCAtMTkxLDYgKzE5MiwyMSBA
QCBzdHJ1Y3QgZXRuYV9jb250ZXh0IHsKIAogICAgc3RydWN0IGV0bmFfYm8gKmR1bW15X3J0Owog
ICAgc3RydWN0IGV0bmFfcmVsb2MgZHVtbXlfcnRfcmVsb2M7CisKKyAgIC8qIGFic3RyYWN0aW9u
IHRvIHN1cHBvcnQgZGlmZmVyZW50IGNvbXBpbGVycyBiYWNrZW5kcyAqLworICAgdWludDMyX3Qg
KCp1bmlmb3JtX2RpcnR5X2ZsYWdzKShjb25zdCB2b2lkICpzb2JqKTsKKyAgIHZvaWQgKCp1bmlm
b3Jtc193cml0ZSkoY29uc3Qgc3RydWN0IGV0bmFfY29udGV4dCAqY3R4LAorICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCB2b2lkICpzb2JqLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgcGlwZV9jb25zdGFudF9idWZmZXIgKmNiLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICB1aW50MzJfdCAqdW5pZm9ybXMsCisgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkICpzaXplKTsKKyAgIHVpbnQzMl90ICgqdW5pZm9ybXNfY29uc3RfY291bnQpKGNvbnN0IHZv
aWQgKnNvYmopOworCisgICB2b2lkICooKmNyZWF0ZV9zaGFkZXJfdmFyaWFudCkodm9pZCAqc2hh
ZGVyLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBldG5hX3NoYWRl
cl9rZXkga2V5LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBwaXBl
X2RlYnVnX2NhbGxiYWNrICpkZWJ1Zyk7CisgICBib29sICgqc2hhZGVyX2xpbmspKHN0cnVjdCBl
dG5hX2NvbnRleHQgKmN0eCk7CisgICBib29sICgqc2hhZGVyX3VwZGF0ZV92ZXJ0ZXgpKHN0cnVj
dCBldG5hX2NvbnRleHQgKmN0eCk7CiB9OwogCiBzdGF0aWMgaW5saW5lIHN0cnVjdCBldG5hX2Nv
bnRleHQgKgpkaWZmIC0tZ2l0IGEvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZf
ZW1pdC5jIGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfZW1pdC5jCmluZGV4
IGVkN2I3ZWUzY2I4Li5mNmYyZDgzZTYwNyAxMDA2NDQKLS0tIGEvc3JjL2dhbGxpdW0vZHJpdmVy
cy9ldG5hdml2L2V0bmF2aXZfZW1pdC5jCisrKyBiL3NyYy9nYWxsaXVtL2RyaXZlcnMvZXRuYXZp
di9ldG5hdml2X2VtaXQuYwpAQCAtMTA1LDggKzEwNSw4IEBAIHJlcXVpcmVkX3N0cmVhbV9zaXpl
KHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCkKICAgIHNpemUgKz0gY3R4LT52ZXJ0ZXhfZWxlbWVu
dHMtPm51bV9lbGVtZW50cyArIDE7CiAKICAgIC8qIHVuaWZvcm1zIC0gd29yc3QgY2FzZSAoMiB3
b3JkcyBwZXIgdW5pZm9ybSBsb2FkKSAqLwotICAgc2l6ZSArPSBjdHgtPnNoYWRlci52cy0+dW5p
Zm9ybXMuY29uc3RfY291bnQgKiAyOwotICAgc2l6ZSArPSBjdHgtPnNoYWRlci5mcy0+dW5pZm9y
bXMuY29uc3RfY291bnQgKiAyOworICAgc2l6ZSArPSBjdHgtPnVuaWZvcm1zX2NvbnN0X2NvdW50
KGN0eC0+c2hhZGVyLnZzKSAqIDI7CisgICBzaXplICs9IGN0eC0+dW5pZm9ybXNfY29uc3RfY291
bnQoY3R4LT5zaGFkZXIuZnMpICogMjsKIAogICAgLyogc2hhZGVyICovCiAgICBzaXplICs9IGN0
eC0+c2hhZGVyX3N0YXRlLnZzX2luc3RfbWVtX3NpemUgKyAxOwpAQCAtNTc3LDEzICs1NzcsMTMg
QEAgZXRuYV9lbWl0X3N0YXRlKHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCkKICAgIHN0YXRpYyBj
b25zdCB1aW50MzJfdCB1bmlmb3JtX2RpcnR5X2JpdHMgPQogICAgICAgRVROQV9ESVJUWV9TSEFE
RVIgfCBFVE5BX0RJUlRZX0NPTlNUQlVGOwogCi0gICBpZiAoZGlydHkgJiAodW5pZm9ybV9kaXJ0
eV9iaXRzIHwgY3R4LT5zaGFkZXIuZnMtPnVuaWZvcm1zX2RpcnR5X2JpdHMpKQotICAgICAgZXRu
YV91bmlmb3Jtc193cml0ZSgKKyAgIGlmIChkaXJ0eSAmICh1bmlmb3JtX2RpcnR5X2JpdHMgfCBj
dHgtPnVuaWZvcm1fZGlydHlfZmxhZ3MoY3R4LT5zaGFkZXIudnMpKSkKKyAgICAgIGN0eC0+dW5p
Zm9ybXNfd3JpdGUoCiAgICAgICAgICBjdHgsIGN0eC0+c2hhZGVyLnZzLCAmY3R4LT5jb25zdGFu
dF9idWZmZXJbUElQRV9TSEFERVJfVkVSVEVYXSwKICAgICAgICAgIGN0eC0+c2hhZGVyX3N0YXRl
LlZTX1VOSUZPUk1TLCAmY3R4LT5zaGFkZXJfc3RhdGUudnNfdW5pZm9ybXNfc2l6ZSk7CiAKLSAg
IGlmIChkaXJ0eSAmICh1bmlmb3JtX2RpcnR5X2JpdHMgfCBjdHgtPnNoYWRlci52cy0+dW5pZm9y
bXNfZGlydHlfYml0cykpCi0gICAgICBldG5hX3VuaWZvcm1zX3dyaXRlKAorICAgaWYgKGRpcnR5
ICYgKHVuaWZvcm1fZGlydHlfYml0cyB8IGN0eC0+dW5pZm9ybV9kaXJ0eV9mbGFncyhjdHgtPnNo
YWRlci5mcykpKQorICAgICAgY3R4LT51bmlmb3Jtc193cml0ZSgKICAgICAgICAgIGN0eCwgY3R4
LT5zaGFkZXIuZnMsICZjdHgtPmNvbnN0YW50X2J1ZmZlcltQSVBFX1NIQURFUl9GUkFHTUVOVF0s
CiAgICAgICAgICBjdHgtPnNoYWRlcl9zdGF0ZS5QU19VTklGT1JNUywgJmN0eC0+c2hhZGVyX3N0
YXRlLnBzX3VuaWZvcm1zX3NpemUpOwogCkBAIC02OTQsNyArNjk0LDcgQEAgZXRuYV9lbWl0X3N0
YXRlKHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCkKICAgICAgIGlmIChkb191bmlmb3JtX2ZsdXNo
KQogICAgICAgICAgZXRuYV9zZXRfc3RhdGUoc3RyZWFtLCBWSVZTX1ZTX1VOSUZPUk1fQ0FDSEUs
IFZJVlNfVlNfVU5JRk9STV9DQUNIRV9GTFVTSCk7CiAgICAgICBldG5hX2NvYWxlc2NlX3N0YXJ0
KHN0cmVhbSwgJmNvYWxlc2NlKTsKLSAgICAgIGZvciAoaW50IHggPSAwOyB4IDwgY3R4LT5zaGFk
ZXIudnMtPnVuaWZvcm1zLmNvbnN0X2NvdW50OyArK3gpIHsKKyAgICAgIGZvciAoaW50IHggPSAw
OyB4IDwgY3R4LT51bmlmb3Jtc19jb25zdF9jb3VudChjdHgtPnNoYWRlci52cyk7ICsreCkgewog
ICAgICAgICAgaWYgKGN0eC0+Z3B1M2QuVlNfVU5JRk9STVNbeF0gIT0gY3R4LT5zaGFkZXJfc3Rh
dGUuVlNfVU5JRk9STVNbeF0pIHsKICAgICAgICAgICAgIGV0bmFfY29hbHNlbmNlX2VtaXQoc3Ry
ZWFtLCAmY29hbGVzY2UsIGN0eC0+c3BlY3MudnNfdW5pZm9ybXNfb2Zmc2V0ICsgeCo0LCBjdHgt
PnNoYWRlcl9zdGF0ZS5WU19VTklGT1JNU1t4XSk7CiAgICAgICAgICAgICBjdHgtPmdwdTNkLlZT
X1VOSUZPUk1TW3hdID0gY3R4LT5zaGFkZXJfc3RhdGUuVlNfVU5JRk9STVNbeF07CkBAIC03MDYs
NyArNzA2LDcgQEAgZXRuYV9lbWl0X3N0YXRlKHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCkKICAg
ICAgIGlmIChkb191bmlmb3JtX2ZsdXNoKQogICAgICAgICAgZXRuYV9zZXRfc3RhdGUoc3RyZWFt
LCBWSVZTX1ZTX1VOSUZPUk1fQ0FDSEUsIFZJVlNfVlNfVU5JRk9STV9DQUNIRV9GTFVTSCB8IFZJ
VlNfVlNfVU5JRk9STV9DQUNIRV9QUyk7CiAgICAgICBldG5hX2NvYWxlc2NlX3N0YXJ0KHN0cmVh
bSwgJmNvYWxlc2NlKTsKLSAgICAgIGZvciAoaW50IHggPSAwOyB4IDwgY3R4LT5zaGFkZXIuZnMt
PnVuaWZvcm1zLmNvbnN0X2NvdW50OyArK3gpIHsKKyAgICAgIGZvciAoaW50IHggPSAwOyB4IDwg
Y3R4LT51bmlmb3Jtc19jb25zdF9jb3VudChjdHgtPnNoYWRlci5mcyk7ICsreCkgewogICAgICAg
ICAgaWYgKGN0eC0+Z3B1M2QuUFNfVU5JRk9STVNbeF0gIT0gY3R4LT5zaGFkZXJfc3RhdGUuUFNf
VU5JRk9STVNbeF0pIHsKICAgICAgICAgICAgIGV0bmFfY29hbHNlbmNlX2VtaXQoc3RyZWFtLCAm
Y29hbGVzY2UsIGN0eC0+c3BlY3MucHNfdW5pZm9ybXNfb2Zmc2V0ICsgeCo0LCBjdHgtPnNoYWRl
cl9zdGF0ZS5QU19VTklGT1JNU1t4XSk7CiAgICAgICAgICAgICBjdHgtPmdwdTNkLlBTX1VOSUZP
Uk1TW3hdID0gY3R4LT5zaGFkZXJfc3RhdGUuUFNfVU5JRk9STVNbeF07CmRpZmYgLS1naXQgYS9z
cmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYvZXRuYXZpdl9zaGFkZXIuYyBiL3NyYy9nYWxsaXVt
L2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X3NoYWRlci5jCmluZGV4IDAzYmE5NGZmNWZhLi4zNGM1
NDZjM2M2NiAxMDA2NDQKLS0tIGEvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZf
c2hhZGVyLmMKKysrIGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfc2hhZGVy
LmMKQEAgLTM3MCwxMCArMzcwLDExIEBAIGZhaWw6CiAgICByZXR1cm4gTlVMTDsKIH0KIAotc3Ry
dWN0IGV0bmFfc2hhZGVyX3ZhcmlhbnQgKgotZXRuYV9zaGFkZXJfdmFyaWFudChzdHJ1Y3QgZXRu
YV9zaGFkZXIgKnNoYWRlciwgc3RydWN0IGV0bmFfc2hhZGVyX2tleSBrZXksCit2b2lkICoKK2V0
bmFfc2hhZGVyX3ZhcmlhbnQodm9pZCAqcywgc3RydWN0IGV0bmFfc2hhZGVyX2tleSBrZXksCiAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHBpcGVfZGVidWdfY2FsbGJhY2sgKmRlYnVnKQogewor
ICAgc3RydWN0IGV0bmFfc2hhZGVyICpzaGFkZXIgPSAoc3RydWN0IGV0bmFfc2hhZGVyICopczsK
ICAgIHN0cnVjdCBldG5hX3NoYWRlcl92YXJpYW50ICp2OwogCiAgICBmb3IgKHYgPSBzaGFkZXIt
PnZhcmlhbnRzOyB2OyB2ID0gdi0+bmV4dCkKZGlmZiAtLWdpdCBhL3NyYy9nYWxsaXVtL2RyaXZl
cnMvZXRuYXZpdi9ldG5hdml2X3NoYWRlci5oIGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2
L2V0bmF2aXZfc2hhZGVyLmgKaW5kZXggMTIxZDU4MTViYTAuLmFmMjFkNzAxN2JjIDEwMDY0NAot
LS0gYS9zcmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYvZXRuYXZpdl9zaGFkZXIuaAorKysgYi9z
cmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYvZXRuYXZpdl9zaGFkZXIuaApAQCAtNzIsOCArNzIs
OCBAQCBldG5hX3NoYWRlcl9saW5rKHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCk7CiBib29sCiBl
dG5hX3NoYWRlcl91cGRhdGVfdmVydGV4KHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCk7CiAKLXN0
cnVjdCBldG5hX3NoYWRlcl92YXJpYW50ICoKLWV0bmFfc2hhZGVyX3ZhcmlhbnQoc3RydWN0IGV0
bmFfc2hhZGVyICpzaGFkZXIsIHN0cnVjdCBldG5hX3NoYWRlcl9rZXkga2V5LAordm9pZCAqCitl
dG5hX3NoYWRlcl92YXJpYW50KHZvaWQgKnNoYWRlciwgc3RydWN0IGV0bmFfc2hhZGVyX2tleSBr
ZXksCiAgICAgICAgICAgICAgICAgICAgc3RydWN0IHBpcGVfZGVidWdfY2FsbGJhY2sgKmRlYnVn
KTsKIAogdm9pZApkaWZmIC0tZ2l0IGEvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2
aXZfc3RhdGUuYyBiL3NyYy9nYWxsaXVtL2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X3N0YXRlLmMK
aW5kZXggZTIzNzIyYjBkMmYuLmUzYzBkMDE5YWE1IDEwMDY0NAotLS0gYS9zcmMvZ2FsbGl1bS9k
cml2ZXJzL2V0bmF2aXYvZXRuYXZpdl9zdGF0ZS5jCisrKyBiL3NyYy9nYWxsaXVtL2RyaXZlcnMv
ZXRuYXZpdi9ldG5hdml2X3N0YXRlLmMKQEAgLTYyMSw2ICs2MjEsMTggQEAgZXRuYV91cGRhdGVf
dHNfY29uZmlnKHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCkKICAgIHJldHVybiB0cnVlOwogfQog
CitzdGF0aWMgaW5saW5lIGJvb2wKK3NoYWRlcl91cGRhdGVfdmVydGV4KHN0cnVjdCBldG5hX2Nv
bnRleHQgKmN0eCkKK3sKKyAgIHJldHVybiBjdHgtPnNoYWRlcl91cGRhdGVfdmVydGV4KGN0eCk7
Cit9CisKK3N0YXRpYyBpbmxpbmUgYm9vbAorc2hhZGVyX2xpbmsoc3RydWN0IGV0bmFfY29udGV4
dCAqY3R4KQoreworICAgcmV0dXJuIGN0eC0+c2hhZGVyX2xpbmsoY3R4KTsKK30KKwogc3RydWN0
IGV0bmFfc3RhdGVfdXBkYXRlciB7CiAgICBib29sICgqdXBkYXRlKShzdHJ1Y3QgZXRuYV9jb250
ZXh0ICpjdHgpOwogICAgdWludDMyX3QgZGlydHk7CkBAIC02MjgsMTAgKzY0MCwxMCBAQCBzdHJ1
Y3QgZXRuYV9zdGF0ZV91cGRhdGVyIHsKIAogc3RhdGljIGNvbnN0IHN0cnVjdCBldG5hX3N0YXRl
X3VwZGF0ZXIgZXRuYV9zdGF0ZV91cGRhdGVzW10gPSB7CiAgICB7Ci0gICAgICBldG5hX3NoYWRl
cl91cGRhdGVfdmVydGV4LCBFVE5BX0RJUlRZX1NIQURFUiB8IEVUTkFfRElSVFlfVkVSVEVYX0VM
RU1FTlRTLAorICAgICAgc2hhZGVyX3VwZGF0ZV92ZXJ0ZXgsIEVUTkFfRElSVFlfU0hBREVSIHwg
RVROQV9ESVJUWV9WRVJURVhfRUxFTUVOVFMsCiAgICB9LAogICAgewotICAgICAgZXRuYV9zaGFk
ZXJfbGluaywgRVROQV9ESVJUWV9TSEFERVIsCisgICAgICBzaGFkZXJfbGluaywgRVROQV9ESVJU
WV9TSEFERVIsCiAgICB9LAogICAgewogICAgICAgZXRuYV91cGRhdGVfYmxlbmQsIEVUTkFfRElS
VFlfQkxFTkQgfCBFVE5BX0RJUlRZX0ZSQU1FQlVGRkVSCmRpZmYgLS1naXQgYS9zcmMvZ2FsbGl1
bS9kcml2ZXJzL2V0bmF2aXYvZXRuYXZpdl91bmlmb3Jtcy5jIGIvc3JjL2dhbGxpdW0vZHJpdmVy
cy9ldG5hdml2L2V0bmF2aXZfdW5pZm9ybXMuYwppbmRleCBhOGQ5NzBkMTg1YS4uYWFiMmE1NjAx
YTAgMTAwNjQ0Ci0tLSBhL3NyYy9nYWxsaXVtL2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X3VuaWZv
cm1zLmMKKysrIGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfdW5pZm9ybXMu
YwpAQCAtNTksMTAgKzU5LDExIEBAIGdldF90ZXhyZWN0X3NjYWxlKGNvbnN0IHN0cnVjdCBldG5h
X2NvbnRleHQgKmN0eCwgYm9vbCBmcmFnLAogCiB2b2lkCiBldG5hX3VuaWZvcm1zX3dyaXRlKGNv
bnN0IHN0cnVjdCBldG5hX2NvbnRleHQgKmN0eCwKLSAgICAgICAgICAgICAgICAgICAgY29uc3Qg
c3RydWN0IGV0bmFfc2hhZGVyX3ZhcmlhbnQgKnNvYmosCisgICAgICAgICAgICAgICAgICAgIGNv
bnN0IHZvaWQgKnYsCiAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBwaXBlX2NvbnN0YW50X2J1
ZmZlciAqY2IsIHVpbnQzMl90ICp1bmlmb3JtcywKICAgICAgICAgICAgICAgICAgICAgdW5zaWdu
ZWQgKnNpemUpCiB7CisgICBjb25zdCBzdHJ1Y3QgZXRuYV9zaGFkZXJfdmFyaWFudCAqc29iaiA9
IChjb25zdCBzdHJ1Y3QgZXRuYV9zaGFkZXJfdmFyaWFudCAqKXY7CiAgICBjb25zdCBzdHJ1Y3Qg
ZXRuYV9zaGFkZXJfdW5pZm9ybV9pbmZvICp1aW5mbyA9ICZzb2JqLT51bmlmb3JtczsKICAgIGJv
b2wgZnJhZyA9IGZhbHNlOwogCkBAIC0xMTYsMyArMTE3LDE5IEBAIGV0bmFfc2V0X3NoYWRlcl91
bmlmb3Jtc19kaXJ0eV9mbGFncyhzdHJ1Y3QgZXRuYV9zaGFkZXJfdmFyaWFudCAqc29iaikKIAog
ICAgc29iai0+dW5pZm9ybXNfZGlydHlfYml0cyA9IGRpcnR5OwogfQorCit1aW50MzJfdAorZXRu
YV91bmlmb3JtX2RpcnR5X2ZsYWdzKGNvbnN0IHZvaWQgKnYpCit7CisgICBjb25zdCBzdHJ1Y3Qg
ZXRuYV9zaGFkZXJfdmFyaWFudCAqc29iaiA9IChjb25zdCBzdHJ1Y3QgZXRuYV9zaGFkZXJfdmFy
aWFudCAqKXY7CisKKyAgIHJldHVybiBzb2JqLT51bmlmb3Jtc19kaXJ0eV9iaXRzOworfQorCit1
aW50MzJfdAorZXRuYV91bmlmb3Jtc19jb25zdF9jb3VudChjb25zdCB2b2lkICp2KQoreworICAg
Y29uc3Qgc3RydWN0IGV0bmFfc2hhZGVyX3ZhcmlhbnQgKnNvYmogPSAoY29uc3Qgc3RydWN0IGV0
bmFfc2hhZGVyX3ZhcmlhbnQgKil2OworCisgICByZXR1cm4gc29iai0+dW5pZm9ybXMuY29uc3Rf
Y291bnQ7Cit9CmRpZmYgLS1naXQgYS9zcmMvZ2FsbGl1bS9kcml2ZXJzL2V0bmF2aXYvZXRuYXZp
dl91bmlmb3Jtcy5oIGIvc3JjL2dhbGxpdW0vZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfdW5pZm9y
bXMuaAppbmRleCAxZGFjZDJhODVkOC4uNWMzODFlMzAxMjAgMTAwNjQ0Ci0tLSBhL3NyYy9nYWxs
aXVtL2RyaXZlcnMvZXRuYXZpdi9ldG5hdml2X3VuaWZvcm1zLmgKKysrIGIvc3JjL2dhbGxpdW0v
ZHJpdmVycy9ldG5hdml2L2V0bmF2aXZfdW5pZm9ybXMuaApAQCAtMzUsMTEgKzM1LDE3IEBAIHN0
cnVjdCBwaXBlX2NvbnN0YW50X2J1ZmZlcjsKIAogdm9pZAogZXRuYV91bmlmb3Jtc193cml0ZShj
b25zdCBzdHJ1Y3QgZXRuYV9jb250ZXh0ICpjdHgsCi0gICAgICAgICAgICAgICAgICAgIGNvbnN0
IHN0cnVjdCBldG5hX3NoYWRlcl92YXJpYW50ICpzb2JqLAorICAgICAgICAgICAgICAgICAgICBj
b25zdCB2b2lkICpzb2JqLAogICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcGlwZV9jb25zdGFu
dF9idWZmZXIgKmNiLCB1aW50MzJfdCAqdW5pZm9ybXMsCiAgICAgICAgICAgICAgICAgICAgIHVu
c2lnbmVkICpzaXplKTsKIAogdm9pZAogZXRuYV9zZXRfc2hhZGVyX3VuaWZvcm1zX2RpcnR5X2Zs
YWdzKHN0cnVjdCBldG5hX3NoYWRlcl92YXJpYW50ICpzb2JqKTsKIAordWludDMyX3QKK2V0bmFf
dW5pZm9ybXNfY29uc3RfY291bnQoY29uc3Qgdm9pZCAqdik7CisKK3VpbnQzMl90CitldG5hX3Vu
aWZvcm1fZGlydHlfZmxhZ3MoY29uc3Qgdm9pZCAqdik7CisKICNlbmRpZiAvKiBFVE5BVklWX1VO
SUZPUk1TX0hfICovCi0tIAoyLjIxLjAKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fCmV0bmF2aXYgbWFpbGluZyBsaXN0CmV0bmF2aXZAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8v
ZXRuYXZpdg==
